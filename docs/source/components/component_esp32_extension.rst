.. note::

    こんにちは、SunFounderのRaspberry Pi & Arduino & ESP32愛好家コミュニティへようこそ！Facebook上でRaspberry Pi、Arduino、ESP32についてもっと深く掘り下げ、他の愛好家と交流しましょう。

    **参加する理由は？**

    - **エキスパートサポート**：コミュニティやチームの助けを借りて、販売後の問題や技術的な課題を解決します。
    - **学び＆共有**：ヒントやチュートリアルを交換してスキルを向上させましょう。
    - **独占的なプレビュー**：新製品の発表や先行プレビューに早期アクセスしましょう。
    - **特別割引**：最新製品の独占割引をお楽しみください。
    - **祭りのプロモーションとギフト**：ギフトや祝日のプロモーションに参加しましょう。

    👉 私たちと一緒に探索し、創造する準備はできていますか？[|link_sf_facebook|]をクリックして今すぐ参加しましょう！

.. _cpn_esp32_wroom_32e:

ESP32 WROOM 32E
=================

ESP32 WROOM-32Eは、EspressifのESP32チップセットを中心に構築された多機能で高性能なモジュールです。デュアルコア処理、統合されたWi-FiとBluetooth接続を提供し、多くの周辺インターフェイスを誇ります。低電力消費で知られるこのモジュールは、IoTアプリケーションに理想的で、コンパクトな形状でのスマートな接続と堅牢な性能を実現します。

.. image:: img/esp32_wroom_32e.jpg
    :width: 600
    :align: center

主な特徴は以下の通りです：

* **処理能力**：デュアルコアのXtensa® 32-bit LX6マイクロプロセッサを搭載し、スケーラビリティと柔軟性を提供します。
* **ワイヤレス機能**：統合された2.4 GHz Wi-FiとデュアルモードBluetoothにより、安定した無線通信を要求するアプリケーションに最適です。
* **メモリ＆ストレージ**：十分なSRAMと高性能のフラッシュストレージを備えており、ユーザープログラムとデータの保存ニーズに対応します。
* **GPIO**：最大34のGPIOピンを提供し、さまざまな外部デバイスやセンサーをサポートします。
* **低電力消費**：複数の省電力モードが利用可能で、バッテリー駆動またはエネルギー効率の良いシナリオに最適です。
* **セキュリティ**：統合された暗号化およびセキュリティ機能により、ユーザーデータとプライバシーがしっかりと保護されます。
* **多機能性**：シンプルな家電から複雑な産業機械まで、WROOM-32Eは一貫した効率的な性能を提供します。

要するに、ESP32 WROOM-32Eは、堅牢な処理能力と多様な接続オプションを提供するだけでなく、IoTやスマートデバイス分野での選択肢としての特長を誇っています。

* |link_esp32_datasheet|

.. _esp32_pinout:

ピンアウト図
-------------------------

ESP32には、いくつかの機能が特定のピンを共有するためのピン使用制限があります。プロジェクトを設計する際、正しく機能するように、また問題を避けるためにピン使用を慎重に計画し、潜在的な競合を確認することが良い方法です。

.. image:: img/esp32_pinout.jpg
    :width: 800
    :align: center

主な制限と考慮事項は以下のとおりです：

* **ADC1およびADC2**：WiFiまたはBluetoothがアクティブの場合、ADC2は使用できません。ただし、ADC1は制限なしに使用できます。
* **ブートストラッピングピン**：GPIO0、GPIO2、GPIO5、GPIO12、およびGPIO15は、ブートプロセス中のブートストラッピングに使用されます。これらのピンにブートプロセスに干渉する可能性のある外部コンポーネントを接続しないよう注意する必要があります。
* **JTAGピン**：GPIO12、GPIO13、GPIO14、およびGPIO15は、デバッグのためのJTAGピンとして使用できます。JTAGデバッグが不要な場合、これらのピンは通常のGPIOとして使用できます。
* **タッチピン**：一部のピンはタッチ機能をサポートします。タッチセンシングのためにこれらのピンを使用する予定の場合、慎重に使用する必要があります。
* **電源ピン**：一部のピンは電源関連の機能のために予約されており、それに応じて使用する必要があります。例えば、3V3やGNDのような電源供給ピンから過度な電流を引き出さないよう注意する必要があります。
* **入力専用ピン**：一部のピンは入力専用であり、出力として使用するべきではありません。

.. _esp32_strapping:

ストラッピングピン
--------------------------

ESP32には5つのストラッピングピンがあります：

.. list-table::
    :widths: 5 15
    :header-rows: 1

    *   - ストラッピングピン
        - 説明
    *   - IO5
        - デフォルトでプルアップされ、IO5とIO15の電圧レベルがSDIOスレーブのタイミングに影響します。
    *   - IO0
        - デフォルトでプルアップされ、ローに引っ張られるとダウンロードモードに入ります。
    *   - IO2
        - デフォルトでプルダウンされ、IO0とIO2はESP32をダウンロードモードにします。
    *   - IO12(MTDI)
        - デフォルトでプルダウンされ、ハイに引っ張られると、ESP32は正常に起動しなくなります。
    *   - IO15(MTDO)
        - デフォルトでプルアップされ、ローに引っ張られると、デバッグログが表示されなくなります。さらに、IO5とIO15の電圧レベルがSDIOスレーブのタイミングに影響します。

ソフトウェアは、レジスタ"GPIO_STRAPPING"からこれら5つのビットの値を読み取ることができます。
チップのシステムリセットが解放される際（電源オンリセット、RTCウォッチドッグリセット、ブラウンアウトリセット）、
ストラッピングピンのラッチは電圧レベルを"0"または"1"のストラッピングビットとしてサンプルし、チップが
電源オフまたはシャットダウンされるまでこれらのビットを保持します。ストラッピングビットはデバイスのブートモード、
VDD_SDIOの動作電圧、およびその他の初期システム設定を設定します。

各ストラッピングピンは、チップリセット中にその内部のプルアップ/プルダウンに接続されています。その結果、
ストラッピングピンが未接続であるか、接続された外部回路が高インピーダンスの場合、内部の弱いプルアップ/プルダウンが
ストラッピングピンのデフォルトの入力レベルを決定します。

ストラッピングビットの値を変更するには、外部のプルダウン/プルアップ抵抗を適用するか、ESP32の電源を入れるときにホストMCUのGPIOを使用してこれらのピンの電圧レベルを制御することができます。

リセット解放後、ストラッピングピンは通常の機能ピンとして動作します。
ストラッピングピンによる詳細なブートモードの設定については、以下の表を参照してください。


.. image:: img/esp32_strapping.png

* FE：フォーリングエッジ、RE：ライジングエッジ
* ブート後、ファームウェアはレジスタビットを設定して、「内部LDOの電圧(VDD_SDIO)」および「SDIOスレーブのタイミング」の設定を変更することができます。
* このモジュールは3.3VのSPIフラッシュを統合しているため、モジュールの電源が入っているときに、MTDIピンを1に設定することはできません。


.. _cpn_esp32_camera_extension:


ESP32カメラ拡張ボード
----------------------------

ESP32 WROOM 32EのカメラとSDカード機能を最大限に活用できる拡張ボードを設計しました。OV2640カメラ、Micro SD、およびESP32 WROOM 32Eを組み合わせることで、オールインワンの拡張ボードが得られます。

このボードは、2種類のGPIOヘッダーを提供しています。一つは、素早いプロトタイピングプロジェクトに最適なメスヘッダー付き。もう一つはネジ端子を備えており、安定したワイヤ接続が可能で、IoTプロジェクトに適しています。

さらに、プロジェクトは単一の3.7V 18650バッテリーで電源を供給することができます。バッテリーの残量が少なくなった場合は、5VのMicro USBケーブルを接続するだけで充電することができます。これにより、屋外プロジェクトやリモートアプリケーションに最適なツールとなります。

.. image:: img/esp32_camera_extension.jpg
    :width: 600
    :align: center

インターフェースの紹介
----------------------

.. image:: img/esp32_camera_extension_pinout.jpg
    :width: 800
    :align: center

* **電源スイッチ**
    * バッテリーの電源供給を制御し、オン/オフを切り替えます。

* **充電ポート**
    * 5VのMicro USBケーブルを接続すると、バッテリーを充電できます。

* **バッテリーポート**
    * PH2.0-2Pインターフェースを採用し、3.7V 18650リチウムバッテリーと互換性があります。
    * ESP32 WROOM 32EとESP32カメラ拡張の両方に電源を供給します。

* **ESP32ピンヘッダー**
    * ESP32 WROOM 32Eモジュール専用。向きに注意し、Micro USBポートが同じ側を向いていることを確認して、誤った配置を避けてください。

* **GPIOヘッダー**
    * **メスヘッダー**: ESP32にさまざまなコンポーネントを接続するためのもので、迅速なプロトタイピングプロジェクトに適しています。
    * **ネジ端子**: 3.5mmピッチ14pinネジ端子を採用しており、安定したワイヤ接続が可能で、IoTプロジェクトに適しています。

* **インジケーターライト**
    * **PWR**: バッテリーが電源供給されているか、Micro USBがESP32に直接接続されているときに点灯します。
    * **CHG**: Micro USBをボードの充電ポートに接続すると点灯し、充電が開始されたことを示します。バッテリーが完全に充電されると、消灯します。

* **Micro SDコネクタ**
    * Micro SDカードの簡単な挿入と取り出しのためのバネ式スロット。

* **24ピン 0.5mm FFC/FPCコネクタ**
    * OV2640カメラ専用で、さまざまなビジョン関連のプロジェクトに適しています。


ESP32カメラ拡張ボードのピン配置
--------------------------------

ESP32 WROOM 32Eのピン配置図は、 :ref:`esp32_pinout` にあります。

しかし、ESP32 WROOM 32Eを拡張ボードに挿入すると、そのピンの一部はMicro SDカードやカメラを駆動するためにも使用されることがあります。

その結果、これらのピンにはプルアップまたはプルダウン抵抗が追加されています。これらのピンを入力として使用する場合、入力レベルに影響を与える可能性があるため、これらの抵抗を考慮することが重要です。

右側のピンのピン配置表は次のとおりです：

    .. image:: img/esp32_extension_pinout1.jpg
        :width: 100%
        :align: center

左側のピンのピン配置表は次のとおりです：

    .. image:: img/esp32_extension_pinout2.jpg
        :width: 100%
        :align: center

    .. note::

        特定の制約がいくつかあります：

        * **IO33** は4.7Kのプルアップ抵抗とフィルタリングコンデンサに接続されており、WS2812 RGBストリップを駆動することを防ぎます。

インターフェース挿入ガイド
-------------------------------

**コードのアップロード**

    ESP32 WROOM 32Eにコードをアップロードする必要がある場合、Micro USBケーブルを使用してコンピュータに接続します。

    .. image:: ../img/plugin_esp32.png
        :width: 600
        :align: center

**Micro SDカードの挿入**

    Micro SDカードを優しく押し込み、しっかりと固定します。もう一度押すと取り出されます。

    .. image:: ../img/insert_sd.png
        :width: 600
        :align: center

**カメラの接続**

    カメラを接続するとき、FPCケーブルの黒いストライプが上向きで、コネクタに完全に挿入されていることを確認してください。

    .. raw:: html

        <video loop autoplay muted style = "max-width:100%">
            <source src="../_static/video/plugin_camera.mp4" type="video/mp4">
            ブラウザはビデオタグをサポートしていません。
        </video>

**バッテリーの電源と充電**

    バッテリーケーブルをバッテリーポートに注意深く挿入し、バッテリーターミナルを上に押し上げるのを防ぐために過度な力を避けます。ターミナルが上に押し上げられた場合、ピンが壊れていなければ問題ありません。位置に戻すだけで良いです。

    .. image:: ../img/plugin_battery.png
        :width: 600
        :align: center

    バッテリーが消耗している場合、5VのMicro USBを接続して充電します。


    .. image:: ../img/battery_charge.png
        :width: 600
        :align: center
